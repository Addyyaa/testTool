import pandas as pd

# 构建测试用例清单
test_cases = [
    # NFC 功能
    ("NFC-001", "首次激活流程", "贴近手机 → 网页跳转 → 下载App → 绑定星盘", "网页跳转正常，App成功下载并完成绑定"),
    ("NFC-002", "每日NFC唤醒", "App推送幸运色 → 手机触碰同步", "珠子变色与App星盘幸运色一致"),
    ("NFC-003", "NFC重复触发", "用户点击触发 → App弹出回应", "App显示卡牌/神秘回应，光效正常"),

    # BLE 交互
    ("BLE-001", "自动连接", "App发起广播 → 发现珠子 → 连接", "无需预配对即可成功连接"),
    ("BLE-002", "变色控制", "App控制珠子变色", "颜色变化与App设定一致，无明显延迟"),
    ("BLE-003", "临时会话稳定性", "多次连接/断开", "BLE连接稳定，无异常中断"),
    ("BLE-004", "低电量通信", "珠子低电量状态下连接", "App仍能完成基本通信"),

    # App 端交互逻辑
    ("APP-001", "首次登录与绑定", "首次登录App → 绑定珠子", "绑定成功，生成幸运色"),
    ("APP-002", "每日幸运色推送", "App推送消息", "推送消息准确，幸运色正确"),
    ("APP-003", "未同步提醒", "未执行每日同步", "App弹窗提醒用户去同步"),
    ("APP-004", "电量提醒", "珠子电量过低", "App弹窗提示“情绪珠缺乏能量，请及时补充”"),

    # 交互动作映射
    ("ACT-001", "轻敲触发", "轻敲珠子", "App检测到动作，触发光效"),
    ("ACT-002", "抬腕触发", "抬起手腕", "App检测到动作，触发光效"),
    ("ACT-003", "连续动作触发", "短时间多次轻敲", "App能正确处理，不遗漏/卡顿"),

    # Web 端逻辑
    ("WEB-001", "首次NFC跳转网页", "NFC触发跳转网页", "页面显示唤醒成功，动效正常"),
    ("WEB-002", "App下载引导", "点击下载App按钮", "iOS/Android下载链接正确"),
    ("WEB-003", "海外访问兼容性", "不同地区网络访问", "网页和下载链接均可访问"),

    # 异常 & 边界情况
    ("ERR-001", "手机NFC关闭", "NFC功能关闭状态", "App或网页提示用户开启NFC"),
    ("ERR-002", "未安装App", "NFC跳转 → App不存在", "网页引导用户下载安装App"),
    ("ERR-003", "BLE连接失败", "App尝试连接珠子失败", "提示用户重试或检查设备"),
    ("ERR-004", "多设备绑定冲突", "两部手机同时尝试控制珠子", "App给出提示，避免控制冲突")
]

# 转换为DataFrame
df = pd.DataFrame(test_cases, columns=["用例编号", "测试点", "操作步骤", "预期结果"])
df.to_excel("测试用例清单.xlsx", index=False)
